#### 目录

* 值语义与对象语义
* 表达式解析

值语义与对象语义

* 值语义

  * 对象的拷贝与原对象无关；**拷贝（调用拷贝构造函数）后**与原对象脱离关系，彼此独立互不影响
  * `int`和`C++`中内置类型都是值语义；标准库类型`string、vector、map`

* 对象语义

  * 面向对象意义下的对象：转换成对象引用方式
    * **对象拷贝禁止`noncopyable`**
      * **拷贝构造函数**设置成私有，不给实现；**赋值运算符**私有，不给实现；
    * 一个对象被系统标准的复制方式复制后，与被复制的对象之间共享底层资源
      * 对任何一个的改变都将改变另一个

* 值语义更好控制

* 对象语义对象生命周期不好控制（智能指针）

  * > `auto_ptr` 所有权独占，不能共享，但可转移
    >
    > `shared_ptr`所有权共享，内部维护一个引用计数，+1，-1，计数归零时清理对象
    >
    > `weak_ptr`弱指针，和`shared_ptr`配合，解决循环引用；获取时不会+1
    >
    > `scoped_ptr`与`auto_ptr`类似，所有权独占，不能共享，不能转移
    >
    > `RAII`资源获取即初始化，两者配合解决内存泄露问题

  * 智能指针将对象语义转化为值语义

* 值语义与对象语义是分析模型决定的，语言的**语法技巧用来匹配模型**

  * > 没有实现**深拷贝的拷贝构造函数**时，都是值语义

  * 基于对象编程  值语义

    * 值语义对象通常以**类对象**的方式来使用
    * 值语义对象的**析构是确定**的

  * 面向对象编程  对象语义

    * 对象语义对象通常用**指针或引用**方式来使用

##### 表达式解析

* 两种方案
  * 逆波兰表示   栈
  * 递归下降法   编译原理 语法树 表达式树
* ![image-20220103223620926](%E5%80%BC%E8%AF%AD%E4%B9%89%E4%B8%8E%E5%AF%B9%E8%B1%A1%E8%AF%AD%E4%B9%89%E3%80%81%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%A7%A3%E6%9E%90.assets/image-20220103223620926.png)
* 表达式
  * 是一个后面有加号或减号的项，加号或减号后面又有另一个表达式
  * 若表达式不含任何加号或减号，它等于此项
  * 表达式也可以为一个项加一个等于号，再加一个表达式
* 一个项
  * 被另一个项乘或除的因子
  * 若一个项不包含任何乘或除运算符，其等于此因子
* 一个因子
  * 一个数字
  * 一个对应某变量的标识符
  * 后面带有一个因子的减号（一元减）
  * 小括号中的整个表达式
* ![image-20220103224614820](%E5%80%BC%E8%AF%AD%E4%B9%89%E4%B8%8E%E5%AF%B9%E8%B1%A1%E8%AF%AD%E4%B9%89%E3%80%81%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%A7%A3%E6%9E%90.assets/image-20220103224614820.png)

##### 代码实现

* 扫描器

  * 负责扫描当前字符，登记当前状态

* 解析器

  * 根据当前扫描结果，进行解析，递归下降解析，直到生成一棵树

* 面向用例编程

  * ```c++
    int main()
    {
        do
        {
            std::cout<<"> ";
            std::string buf;
            std::getline(std::cin,buf);
            std::cout<<buf<<std::endl;
            Scanner scanner(buf);
            Parser parser(scanner);
            parser.Parse();
            parser.Calculate();
        } while (1);
        
        return 0;
    }
    ```

* 后续实现这些类接口即可