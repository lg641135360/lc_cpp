#### 目录

* `vector`源码分析
* `allocator`

##### `vector`源码分析

* ```cpp
  template <class _Ty,class _Ax = allocator<_Ty>>
  class vector;
  ```

  * `allocator`本身是一个类模板；内存分配子（`stl`默认设置）
    * 内存分配子    可自实现（内存池）

* 构造一个类对象

  * 首先构造基类
  * 再构造对象成员
  * 最后类构造函数自身

* 内部的三个指针

  * ![image-20220126001405117](stl%E7%BC%96%E7%A8%8B2.assets/image-20220126001405117.png)

* 剩余容量 `myend-mylast`

* `capacity`容量 `>=` 当前总个数`size()`
  * 缓存一部分内存空间，防止频繁分配内存
    * 下次插入新元素时，不必重新分配
    * 每次扩充`50%`
  * ![image-20220126105006410](stl%E7%BC%96%E7%A8%8B2.assets/image-20220126105006410.png)

##### 如何分配连续空间

* 尾插
  * 先分配所有连续空间，将指定元素插入指定位置，将原来元素搬运过来
* 指定位置插
  * 分配所有连续空间，指定元素插入指定位置，搬运原元素